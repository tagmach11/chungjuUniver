<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PolyTalk ë‹¤êµ­ì–´ ìƒë‹´ - CJU-EDELWEIS</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- ìƒë‹¨ í—¤ë” -->
    <header class="top-header">
        <div class="container">
            <div class="logo-section">
                <img src="img/logo_wave.png" alt="ì²­ì£¼ëŒ€í•™êµ">
            </div>
            <nav class="top-nav">
                <a href="#">ìµœë¯¸ë‚˜ë‹˜ ë°©ë¬¸ì„ í™˜ì˜í•©ë‹ˆë‹¤</a>
                
                <span class="divider">|</span>
                <a href="#">MY PAGE</a>
                <span class="divider">|</span>
                <a href="#">ë¡œê·¸ì•„ì›ƒ</a>
                <span class="divider">|</span>
                <a href="#">ì‚¬ìš©ì ê°€ì´ë“œ</a>
                <span class="divider">|</span>
                <a href="#">Language</a>
            </nav>
        </div>
    </header>

    <!-- ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="main-nav">
        <div class="container">
            <div class="logo">
                <img src="img/logo_edel.png" alt="EDELWEIS">
            </div>
            <ul class="menu">
                <li><a href="index.html">ì†Œê°œ</a></li>
                <li><a href="index.html">MY PAGE</a></li>
                <li><a href="index.html">COUNSEL/CAIR</a></li>
                <li><a href="index.html">CJ MOOC</a></li>
                <li><a href="index.html">OER</a></li>
                <li><a href="index.html">OCW</a></li>
                <li><a href="index.html">Q&A</a></li>
                <li><a href="index.html">ëŒ€í•™ì¼ìë¦¬í”ŒëŸ¬ìŠ¤ì„¼í„°</a></li>
                <li><a href="index.html">Meta-Life,CJU</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero ì„¹ì…˜ (ë°°ê²½ ì´ë¯¸ì§€ + 4ê°œ ë°•ìŠ¤) -->
    <section class="hero-section">
        <div class="hero-overlay"></div>
        <div class="hero-container">
            <div class="hero-grid">
                <!-- 1. êµìˆ˜ í”„ë¡œí•„ -->
                <div class="profile-box">
                    <div class="profile-bg">
                        <div class="profile-dept">êµì§ê³¼</div>
                        <div class="profile-photo">
                            <img src="img/FileController.jpeg" alt="êµìˆ˜ í”„ë¡œí•„">
                        </div>
                        <div class="profile-name">ìµœë¯¸ë‚˜ <span>êµìˆ˜</span></div>
                    </div>
                </div>

                <!-- 2. ìƒë‹´Â·ì§€ë„ ê´€ë¦¬í˜„í™© -->
                <div class="counsel-box">
                    <div class="box-header blue">
                        <h3>ìƒë‹´ Â· ì§€ë„ ê´€ë¦¬í˜„í™©</h3>
                        <button class="plus-btn">+</button>
                    </div>
                    <div class="counsel-tabs">
                        <button class="ctab active">ì „ì²´</button>
                        <button class="ctab">1í•™ë…„</button>
                        <button class="ctab">2í•™ë…„</button>
                        <button class="ctab">3í•™ë…„</button>
                        <button class="ctab">4í•™ë…„</button>
                    </div>
                    <div class="counsel-items">
                        <div class="counsel-item">
                            <span class="label">ìƒë‹´ ë¯¸ì‹¤ì‹œì</span>
                            <span class="value red">0</span>
                        </div>
                        <div class="counsel-item">
                            <span class="label">ìƒë‹´ì™„ë£Œ</span>
                            <span class="value red">0</span>
                        </div>
                        <div class="counsel-item">
                            <span class="label">ë°©ë¬¸ì˜ˆì•½ ìƒë‹´</span>
                            <span class="value red">0</span>
                        </div>
                        <div class="counsel-item">
                            <span class="label">ì˜¨ë¼ì¸ ë‹µë³€ ìš”ì²­</span>
                            <span class="value red">0</span>
                        </div>
                    </div>
                </div>

                <!-- 3. ë‹¬ë ¥ -->
                <div class="calendar-box">
                    <div class="calendar-controls">
                        <button class="cal-nav" id="prevMonth">â€¹</button>
                        <h3 class="cal-month" id="currentMonth">2025. 11</h3>
                        <button class="cal-nav" id="nextMonth">â€º</button>
                        <button class="cal-menu">â˜°</button>
                    </div>
                    <div class="calendar-grid">
                        <div class="cal-header">
                            <div class="cal-day sun">SUN</div>
                            <div class="cal-day">MON</div>
                            <div class="cal-day">TUE</div>
                            <div class="cal-day">WED</div>
                            <div class="cal-day">THU</div>
                            <div class="cal-day">FRI</div>
                            <div class="cal-day sat">SAT</div>
                        </div>
                        <div class="cal-body" id="calendarDays"></div>
                    </div>
                </div>

                <!-- 4. ê³µì§€ì‚¬í•­ -->
                <div class="notice-box">
                    <div class="box-header blue">
                        <h3>ê³µì§€ì‚¬í•­</h3>
                        <button class="plus-btn">+</button>
                    </div>
                    <div class="notice-items">
                        <div class="notice-line">
                            <div class="notice-left">
                                <span class="notice-text">2025-2 02ë¶„ë°˜(ì¡°ê¸°ì·¨ì—…ì) ì‚¬ì´ë²„â€¦</span>
                            </div>
                            <div class="notice-right">
                                <span class="notice-date">11.17</span>
                                <span class="new-badge">N</span>
                            </div>
                        </div>
                        <div class="notice-line">
                            <div class="notice-left">
                                <span class="notice-text">2025-2 ì‚¬ì´ë²„ê°•ì˜ ê¸°ë§ê³ ì‚¬ ì‹œí—˜â€¦</span>
                            </div>
                            <div class="notice-right">
                                <span class="notice-date">11.17</span>
                                <span class="new-badge">N</span>
                            </div>
                        </div>
                        <div class="notice-line">
                            <div class="notice-left">
                                <span class="notice-text">2025-2í•™ê¸° í•™ê³¼ ì²´í—˜ í”„ë¡œê·¸ë¨â€¦</span>
                            </div>
                            <div class="notice-right">
                                <span class="notice-date">11.13</span>
                            </div>
                        </div>
                        <div class="notice-line">
                            <div class="notice-left">
                                <span class="notice-text">2025í•™ë…„ë„ ì „ê³µíƒìƒ‰ ì„¤ëª…íšŒ ì•ˆë‚´</span>
                            </div>
                            <div class="notice-right">
                                <span class="notice-date">11.10</span>
                            </div>
                        </div>
                        <div class="notice-line">
                            <div class="notice-left">
                                <span class="notice-text">[ì •ìƒë³µêµ¬] ì‹¤ì‹œê°„ ë¹„ëŒ€ë©´ í•™ìŠµ(wâ€¦</span>
                            </div>
                            <div class="notice-right">
                                <span class="notice-date">11.06</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- í•˜ë‹¨ ì»¨í…ì¸  -->
    <main class="main-content">
        <div class="container">
            <!-- PolyTalk ë‹¤êµ­ì–´ ìƒë‹´ ì„¹ì…˜ -->
            <section class="polytalk-content-section">
                <div class="course-main-title">
                    <h2 class="main-title-text">ë‹¤êµ­ì–´ <span class="blue-text">ìƒë‹´</span></h2>
                </div>
                <div class="polytalk-main-layout">
                    <!-- ìƒíƒœ ë©”ì‹œì§€ ì˜¤ë²„ë ˆì´ -->
                    <div class="status-message-overlay" id="statusMessageOverlay" style="display: none;">
                        <div class="status-message-box">
                            <div class="status-message-icon">âœ“</div>
                            <div class="status-message-text" id="statusMessageText">ìƒë‹´ì´ ì¢…ë£Œë©ë‹ˆë‹¤</div>
                        </div>
                    </div>
                    
                    <!-- ì™¼ìª½: í•™ìƒ í”„ë¡œí•„ ì •ë³´ -->
                    <div class="student-profile-panel">
                        <div class="profile-header">
                            <div class="profile-avatar">
                                <img src="img/í•™ìƒí”„ë¡œí•„.png" alt="í•™ìƒ í”„ë¡œí•„" class="avatar-image" id="studentAvatar">
                            </div>
                            <div class="profile-name-section">
                                <div class="student-name-row">
                                    <h3 id="studentNameDisplay">MingWha</h3>
                                    <span class="country-flag" id="countryFlag"></span>
                                    <span class="phone-code" id="phoneCode"></span>
                                </div>
                            </div>
                        </div>
                        <div class="profile-info-cards">
                            <div class="info-card">
                                <div class="card-label">í•™ë²ˆ</div>
                                <div class="card-value" id="studentIdDisplay">2261029</div>
                            </div>
                            <div class="info-card">
                                <div class="card-label">ìƒë‹´ ì£¼ì œ</div>
                                <div class="card-value" id="learningSubject">í•œêµ­ì–´ í•™ìŠµ</div>
                            </div>
                            <div class="info-card">
                                <div class="card-label">ìƒë‹´ ì‹œê°„</div>
                                <div class="card-value" id="learningDuration">2ì‹œê°„</div>
                            </div>
                            <div class="info-card">
                                <div class="card-label">ì „í™”ë²ˆí˜¸</div>
                                <div class="card-value" id="studentPhone">010-1234-5678</div>
                            </div>
                            <div class="info-card">
                                <div class="card-label">ì£¼ ì–¸ì–´</div>
                                <div class="card-value">
                                    
                                    <span id="primaryLanguage">ì¤‘êµ­ì–´</span>
                                </div>
                            </div>
                            
                            <div class="info-card">
                                <div class="card-label">ë§ˆì§€ë§‰ ìƒë‹´</div>
                                <div class="card-value" id="lastLessonDate">2025-03-15</div>
                            </div>
                        </div>
                    </div>

                    <!-- ì˜¤ë¥¸ìª½: ì±„íŒ… ì˜ì—­ -->
                    <div class="chat-panel">
                        <div class="chat-header">
                            <div class="language-select-header">
                                <label>í•™ìƒ ì–¸ì–´:</label>
                                <select id="studentLang">
                                    <option value="ko">í•œêµ­ì–´</option>
                                    <option value="en">ì˜ì–´</option>
                                    <option value="ja">ì¼ë³¸ì–´</option>
                                    <option value="zh" selected>ì¤‘êµ­ì–´</option>
                                    <option value="vi">ë² íŠ¸ë‚¨ì–´</option>
                                </select>
                            </div>
                            <div class="header-right">
                                <div class="translation-status">
                                    <span class="status-dot"></span>
                                    <span class="status-text">ì‹¤ì‹œê°„ ë²ˆì—­ì¤‘</span>
                                </div>
                                <button class="end-counsel-btn" id="endCounselBtn">ìƒë‹´ ì¢…ë£Œ</button>
                            </div>
                        </div>
                        <div class="chat-messages" id="chatMessages">
                            <div class="chat-message student">
                                <div class="message-bubble student">
                                    <div class="message-time">14:30</div>
                                    <div class="message-original">è€å¸ˆæ‚¨å¥½!</div>
                                    <div class="message-translated">ì•ˆë…•í•˜ì„¸ìš”, ì„ ìƒë‹˜!</div>
                                </div>
                            </div>
                            <div class="chat-message professor">
                                <div class="message-bubble professor">
                                    <div class="message-time">14:30</div>
                                    <div class="message-original">ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?</div>
                                    <div class="message-translated">ä½ å¥½!æœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ çš„å—?</div>
                                </div>
                            </div>
                            <div class="chat-message student">
                                <div class="message-bubble student">
                                    <div class="message-time">14:31</div>
                                    <div class="message-original">æˆ‘ä¸çŸ¥é“ä¸‹å‘¨çš„ä½œä¸šåº”è¯¥æ€ä¹ˆåšã€‚</div>
                                    <div class="message-translated">ë‹¤ìŒ ì£¼ ê³¼ì œë¥¼ ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ëª¨ë¥´ê² ì–´ìš”.</div>
                                </div>
                            </div>
                            <div class="chat-message professor">
                                <div class="message-bubble professor">
                                    <div class="message-time">14:31</div>
                                    <div class="message-original">ê³¼ì œì— ëŒ€í•´ ìì„¸íˆ ì„¤ëª…í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë¨¼ì € ê³¼ì œ ì£¼ì œë¥¼ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</div>
                                    <div class="message-translated">æˆ‘ä¼šè¯¦ç»†è§£é‡Šä½œä¸šã€‚é¦–å…ˆè®©æˆ‘ç¡®è®¤ä¸€ä¸‹ä½œä¸šä¸»é¢˜ã€‚</div>
                                </div>
                            </div>
                            <div class="chat-message student">
                                <div class="message-bubble student">
                                    <div class="message-time">14:32</div>
                                    <div class="message-original">è°¢è°¢!</div>
                                    <div class="message-translated">ê°ì‚¬í•©ë‹ˆë‹¤!</div>
                                </div>
                            </div>
                        </div>
                        <div class="chat-input-bottom">
                            <button class="voice-btn" id="voiceBtn" title="ìŒì„± ì…ë ¥">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                                    <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                                    <line x1="12" y1="19" x2="12" y2="23"></line>
                                    <line x1="8" y1="23" x2="16" y2="23"></line>
                                </svg>
                            </button>
                            <input type="text" class="chat-input-main" id="chatInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ ìŒì„± ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”" maxlength="500">
                            <button class="send-btn-main" id="sendBtn">ì „ì†¡</button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- TOP ë²„íŠ¼ -->
    <button class="top-button" id="topBtn">
        <div>â–²</div>
        <div>TOP</div>
    </button>

    <script src="script.js"></script>
    <script>
        // í˜„ì¬ ë‚ ì§œ
        let currentDate = new Date(2025, 10, 1); // 2025ë…„ 11ì›”

        // ë‹¬ë ¥ ë Œë”ë§
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // ì›” í‘œì‹œ
            document.getElementById('currentMonth').textContent = `${year}. ${String(month + 1).padStart(2, '0')}`;
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const firstDayOfWeek = firstDay.getDay();
            const lastDate = lastDay.getDate();
            
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';
            
            // ì´ë²¤íŠ¸ ë‚ ì§œì™€ ë°°ì§€
            const specialDates = {
                1: { type: 'today', badge: { num: 1, color: 'red' } },
                2: { type: 'normal', badge: { num: 2, color: 'red' } },
                4: { type: 'normal', badge: { num: 1, color: 'red' } },
                11: { type: 'normal', badge: { num: 1, color: 'blue' } },
                17: { type: 'green', badge: null }
            };
            
            // ë¹ˆ ì¹¸
            for (let i = 0; i < firstDayOfWeek; i++) {
                const empty = document.createElement('div');
                empty.className = 'cal-date empty';
                calendarDays.appendChild(empty);
            }
            
            // ë‚ ì§œ
            for (let date = 1; date <= lastDate; date++) {
                const dateEl = document.createElement('div');
                dateEl.className = 'cal-date';
                dateEl.textContent = date;
                
                const dayOfWeek = new Date(year, month, date).getDay();
                if (dayOfWeek === 0) dateEl.classList.add('sun');
                if (dayOfWeek === 6) dateEl.classList.add('sat');
                
                // íŠ¹ë³„ ë‚ ì§œ ì²˜ë¦¬
                if (specialDates[date]) {
                    const special = specialDates[date];
                    
                    if (special.type === 'today') {
                        dateEl.classList.add('today');
                    } else if (special.type === 'green') {
                        dateEl.classList.add('green');
                    }
                    
                    // ë°°ì§€ ì¶”ê°€
                    if (special.badge) {
                        const badge = document.createElement('span');
                        badge.className = 'date-badge';
                        if (special.badge.color === 'blue') {
                            badge.classList.add('blue');
                        }
                        badge.textContent = special.badge.num;
                        dateEl.appendChild(badge);
                    }
                }
                
                calendarDays.appendChild(dateEl);
            }
        }

        // ì´ì „/ë‹¤ìŒ ë‹¬
        document.getElementById('prevMonth').addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        });

        document.getElementById('nextMonth').addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        });

        // íƒ­ ì „í™˜
        document.querySelectorAll('.ctab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.ctab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // TOP ë²„íŠ¼
        const topBtn = document.getElementById('topBtn');
        topBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                topBtn.style.display = 'flex';
            } else {
                topBtn.style.display = 'none';
            }
        });

        // í•™ìƒ ì •ë³´ ë°ì´í„° (ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨)
        const countryMap = {
            'ëŒ€í•œë¯¼êµ­': { flag: 'ğŸ‡°ğŸ‡·', code: '+82', lang: 'í•œêµ­ì–´', langFlag: 'ğŸ‡°ğŸ‡·', langCode: 'ko' },
            'ì¤‘êµ­': { flag: 'ğŸ‡¨ğŸ‡³', code: '+86', lang: 'ç®€ä½“ä¸­æ–‡', langFlag: 'ğŸ‡¨ğŸ‡³', langCode: 'zh' },
            'ë² íŠ¸ë‚¨': { flag: 'ğŸ‡»ğŸ‡³', code: '+84', lang: 'Tiáº¿ng Viá»‡t', langFlag: 'ğŸ‡»ğŸ‡³', langCode: 'vi' },
            'ì¼ë³¸': { flag: 'ğŸ‡¯ğŸ‡µ', code: '+81', lang: 'æ—¥æœ¬èª', langFlag: 'ğŸ‡¯ğŸ‡µ', langCode: 'ja' },
            'ë¯¸êµ­': { flag: 'ğŸ‡ºğŸ‡¸', code: '+1', lang: 'English', langFlag: 'ğŸ‡ºğŸ‡¸', langCode: 'en' }
        };
        
        const studentData = {
            'ê¹€ë¯¼ìˆ˜': { id: '20210101', phone: '010-1234-5678', country: 'ëŒ€í•œë¯¼êµ­' },
            'ì´ì§€ì€': { id: '20220202', phone: '010-2345-6789', country: 'ëŒ€í•œë¯¼êµ­' },
            'ë°•ì¤€í˜¸': { id: '20210303', phone: '010-3456-7890', country: 'ëŒ€í•œë¯¼êµ­' },
            'Li Wei': { id: '20220404', phone: '010-4567-8901', country: 'ì¤‘êµ­' },
            'Nguyen Van A': { id: '20210505', phone: '010-5678-9012', country: 'ë² íŠ¸ë‚¨' }
        };

        // URL íŒŒë¼ë¯¸í„°ì—ì„œ í•™ìƒ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        const urlParams = new URLSearchParams(window.location.search);
        const studentName = urlParams.get('name') || '-';
        const studentId = urlParams.get('id') || '-';
        const studentCountry = urlParams.get('country') || 'ëŒ€í•œë¯¼êµ­';
        
        // í•™ìƒ ì •ë³´ í‘œì‹œ
        const studentInfo = studentData[studentName] || { 
            id: studentId, 
            phone: '-', 
            country: studentCountry
        };
        
        const countryInfo = countryMap[studentInfo.country] || countryMap['ëŒ€í•œë¯¼êµ­'];
        const student = {
            ...studentInfo,
            ...countryInfo
        };
        
        document.getElementById('studentNameDisplay').textContent = studentName;
        document.getElementById('studentIdDisplay').textContent = student.id;
        document.getElementById('studentPhone').textContent = student.phone;
        document.getElementById('countryFlag').textContent = student.flag;
        document.getElementById('phoneCode').textContent = student.code;
        document.getElementById('primaryLangFlag').textContent = student.langFlag;
        document.getElementById('primaryLanguage').textContent = student.lang;
        
        // í•™ìƒ ì–¸ì–´ ì„ íƒ ìë™ ì„¤ì •
        const studentLangSelect = document.getElementById('studentLang');
        if (studentLangSelect && student.langCode) {
            studentLangSelect.value = student.langCode;
        }
        
        // í•™ìƒ í”„ë¡œí•„ ì´ë¯¸ì§€ ì„¤ì • (ì´ë¯¸ HTMLì— ì„¤ì •ë˜ì–´ ìˆìœ¼ë¯€ë¡œ í•„ìš”ì‹œ ë™ì ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥)
        // const studentAvatar = document.getElementById('studentAvatar');
        // studentAvatar.src = 'img/í•™ìƒí”„ë¡œí•„.png';
        
        // í˜„ì¬ ì‹œê°„ í‘œì‹œ
        const now = new Date();
        const timeString = `${now.getFullYear()}.${String(now.getMonth() + 1).padStart(2, '0')}.${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
        
        
        // ê°„ë‹¨í•œ ë²ˆì—­ ì‹œë®¬ë ˆì´ì…˜
        function translateText(text, fromLang, toLang) {
            if (fromLang === toLang) return null;
            
            // ì‹¤ì œë¡œëŠ” ë²ˆì—­ APIë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤
            // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•œ ì˜ˆì‹œë§Œ ì œê³µ
            const translations = {
                'ì•ˆë…•í•˜ì„¸ìš”': { en: 'Hello', zh: 'ä½ å¥½', ja: 'ã“ã‚“ã«ã¡ã¯', vi: 'Xin chÃ o' },
                'ê°ì‚¬í•©ë‹ˆë‹¤': { en: 'Thank you', zh: 'è°¢è°¢', ja: 'ã‚ã‚ŠãŒã¨ã†', vi: 'Cáº£m Æ¡n' },
                'ë„¤': { en: 'Yes', zh: 'æ˜¯', ja: 'ã¯ã„', vi: 'VÃ¢ng' },
                'ä½ å¥½': { ko: 'ì•ˆë…•í•˜ì„¸ìš”', en: 'Hello', ja: 'ã“ã‚“ã«ã¡ã¯', vi: 'Xin chÃ o' },
                'è°¢è°¢': { ko: 'ê°ì‚¬í•©ë‹ˆë‹¤', en: 'Thank you', ja: 'ã‚ã‚ŠãŒã¨ã†', vi: 'Cáº£m Æ¡n' },
                'è€å¸ˆæ‚¨å¥½!': { ko: 'ì•ˆë…•í•˜ì„¸ìš”, ì„ ìƒë‹˜!', en: 'Hello, teacher!', ja: 'ã“ã‚“ã«ã¡ã¯ã€å…ˆç”Ÿï¼', vi: 'Xin chÃ o, tháº§y giÃ¡o!' },
                'ì•ˆë…•í•˜ì„¸ìš”, ì„ ìƒë‹˜!': { zh: 'è€å¸ˆæ‚¨å¥½!', en: 'Hello, teacher!', ja: 'ã“ã‚“ã«ã¡ã¯ã€å…ˆç”Ÿï¼', vi: 'Xin chÃ o, tháº§y giÃ¡o!' },
                'ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?': { zh: 'ä½ å¥½!æœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ çš„å—?', en: 'Hello! What can I help you with?', ja: 'ã“ã‚“ã«ã¡ã¯ï¼ä½•ã‹ãŠæ‰‹ä¼ã„ã§ãã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', vi: 'Xin chÃ o! TÃ´i cÃ³ thá»ƒ giÃºp gÃ¬ cho báº¡n?' },
                'æˆ‘ä¸çŸ¥é“ä¸‹å‘¨çš„ä½œä¸šåº”è¯¥æ€ä¹ˆåšã€‚': { ko: 'ë‹¤ìŒ ì£¼ ê³¼ì œë¥¼ ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ëª¨ë¥´ê² ì–´ìš”.', en: 'I don\'t know how to do next week\'s homework.', ja: 'æ¥é€±ã®å®¿é¡Œã‚’ã©ã†ã™ã‚Œã°ã„ã„ã‹ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚', vi: 'TÃ´i khÃ´ng biáº¿t lÃ m tháº¿ nÃ o Ä‘á»ƒ lÃ m bÃ i táº­p tuáº§n tá»›i.' },
                'ë‹¤ìŒ ì£¼ ê³¼ì œë¥¼ ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ëª¨ë¥´ê² ì–´ìš”.': { zh: 'æˆ‘ä¸çŸ¥é“ä¸‹å‘¨çš„ä½œä¸šåº”è¯¥æ€ä¹ˆåšã€‚', en: 'I don\'t know how to do next week\'s homework.', ja: 'æ¥é€±ã®å®¿é¡Œã‚’ã©ã†ã™ã‚Œã°ã„ã„ã‹ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚', vi: 'TÃ´i khÃ´ng biáº¿t lÃ m tháº¿ nÃ o Ä‘á»ƒ lÃ m bÃ i táº­p tuáº§n tá»›i.' },
                'ê³¼ì œì— ëŒ€í•´ ìì„¸íˆ ì„¤ëª…í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë¨¼ì € ê³¼ì œ ì£¼ì œë¥¼ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.': { zh: 'æˆ‘ä¼šè¯¦ç»†è§£é‡Šä½œä¸šã€‚é¦–å…ˆè®©æˆ‘ç¡®è®¤ä¸€ä¸‹ä½œä¸šä¸»é¢˜ã€‚', en: 'I will explain the homework in detail. Let me first check the assignment topic.', ja: 'å®¿é¡Œã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚ã¾ãšå®¿é¡Œã®ãƒ†ãƒ¼ãƒã‚’ç¢ºèªã—ã¾ã™ã€‚', vi: 'TÃ´i sáº½ giáº£i thÃ­ch chi tiáº¿t vá» bÃ i táº­p. Äá»ƒ tÃ´i kiá»ƒm tra chá»§ Ä‘á» bÃ i táº­p trÆ°á»›c.' },
                'ê°ì‚¬í•©ë‹ˆë‹¤!': { zh: 'è°¢è°¢!', en: 'Thank you!', ja: 'ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼', vi: 'Cáº£m Æ¡n báº¡n!' },
                'è°¢è°¢!': { ko: 'ê°ì‚¬í•©ë‹ˆë‹¤!', en: 'Thank you!', ja: 'ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼', vi: 'Cáº£m Æ¡n báº¡n!' }
            };
            
            // ì‹¤ì œë¡œëŠ” Google Translate API ë“±ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤
            // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•œ ë²ˆì—­ ë§¤í•‘ ì‚¬ìš©
            if (translations[text] && translations[text][toLang]) {
                return translations[text][toLang];
            }
            
            // ê¸°ë³¸ ë²ˆì—­ í‘œì‹œ
            return `[ë²ˆì—­: ${text}]`;
        }
        
        // ì±„íŒ… ë©”ì‹œì§€ ì¶”ê°€ í•¨ìˆ˜
        function addChatMessage(text, isProf, translatedText = null) {
            const chatMessages = document.getElementById('chatMessages');
            const welcomeMsg = chatMessages.querySelector('.welcome-message');
            if (welcomeMsg) {
                welcomeMsg.remove();
            }
            
            const now = new Date();
            const timeString = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${isProf ? 'professor' : 'student'}`;
            
            let messageHTML = `
                <div class="message-bubble ${isProf ? 'professor' : 'student'}">
                    <div class="message-time">${timeString}</div>
                    <div class="message-original">${text}</div>
            `;
            
            if (translatedText) {
                messageHTML += `<div class="message-translated">${translatedText}</div>`;
            }
            
            messageHTML += `</div>`;
            messageDiv.innerHTML = messageHTML;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // ì±„íŒ… ì „ì†¡ (êµìˆ˜ì ë©”ì‹œì§€)
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        
        function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            
            const studentLang = document.getElementById('studentLang').value;
            
            // êµìˆ˜ì ë©”ì‹œì§€ (í•œêµ­ì–´) - í•™ìƒ ì–¸ì–´ë¡œ ë²ˆì—­
            const translated = translateText(message, 'ko', studentLang);
            addChatMessage(message, true, translated);
            
            chatInput.value = '';
        }
        
        if (sendBtn) {
            sendBtn.addEventListener('click', sendMessage);
        }
        
        if (chatInput) {
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }
        
        // ì˜ˆì‹œ ëŒ€í™” ë©”ì‹œì§€ ë¡œë“œ
        function loadExampleMessages() {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) {
                console.error('chatMessages ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ê¸°ì¡´ ë©”ì‹œì§€ ì´ˆê¸°í™”
            chatMessages.innerHTML = '';
            
            const studentLangSelect = document.getElementById('studentLang');
            const langCode = studentLangSelect ? studentLangSelect.value : 'zh';
            
            console.log('ì˜ˆì‹œ ë©”ì‹œì§€ ë¡œë“œ ì‹œì‘, ì–¸ì–´:', langCode);
            
            // ì˜ˆì‹œ ëŒ€í™” ë©”ì‹œì§€ë“¤
            const exampleMessages = [
                {
                    text: langCode === 'zh' ? 'è€å¸ˆæ‚¨å¥½!' : (langCode === 'ko' ? 'ì•ˆë…•í•˜ì„¸ìš”, ì„ ìƒë‹˜!' : 'Hello, teacher!'),
                    isProf: false,
                    time: '14:30'
                },
                {
                    text: 'ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?',
                    isProf: true,
                    time: '14:30'
                },
                {
                    text: langCode === 'zh' ? 'æˆ‘ä¸çŸ¥é“ä¸‹å‘¨çš„ä½œä¸šåº”è¯¥æ€ä¹ˆåšã€‚' : (langCode === 'ko' ? 'ë‹¤ìŒ ì£¼ ê³¼ì œë¥¼ ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ëª¨ë¥´ê² ì–´ìš”.' : 'I don\'t know how to do next week\'s homework.'),
                    isProf: false,
                    time: '14:31'
                },
                {
                    text: 'ê³¼ì œì— ëŒ€í•´ ìì„¸íˆ ì„¤ëª…í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë¨¼ì € ê³¼ì œ ì£¼ì œë¥¼ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.',
                    isProf: true,
                    time: '14:31'
                },
                {
                    text: langCode === 'zh' ? 'è°¢è°¢!' : (langCode === 'ko' ? 'ê°ì‚¬í•©ë‹ˆë‹¤!' : 'Thank you!'),
                    isProf: false,
                    time: '14:32'
                }
            ];
            
            // ë©”ì‹œì§€ë“¤ì„ ìˆœì°¨ì ìœ¼ë¡œ ì¶”ê°€ (ì•½ê°„ì˜ ë”œë ˆì´ë¥¼ ë‘ê³ )
            exampleMessages.forEach((msg, index) => {
                setTimeout(() => {
                    try {
                        const translated = translateText(msg.text, msg.isProf ? 'ko' : langCode, msg.isProf ? langCode : 'ko');
                        addChatMessageWithTime(msg.text, msg.isProf, translated, msg.time);
                    } catch (error) {
                        console.error('ë©”ì‹œì§€ ì¶”ê°€ ì˜¤ë¥˜:', error);
                    }
                }, index * 400);
            });
        }
        
        // ì‹œê°„ì„ ì§€ì •í•˜ì—¬ ë©”ì‹œì§€ ì¶”ê°€
        function addChatMessageWithTime(text, isProf, translatedText = null, timeString) {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) {
                console.error('chatMessages ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${isProf ? 'professor' : 'student'}`;
            
            let messageHTML = `
                <div class="message-bubble ${isProf ? 'professor' : 'student'}">
                    <div class="message-time">${timeString}</div>
                    <div class="message-original">${text}</div>
            `;
            
            if (translatedText) {
                messageHTML += `<div class="message-translated">${translatedText}</div>`;
            }
            
            messageHTML += `</div>`;
            messageDiv.innerHTML = messageHTML;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // ìƒë‹´ ì¢…ë£Œ ë²„íŠ¼
        const endCounselBtn = document.getElementById('endCounselBtn');
        const statusMessageOverlay = document.getElementById('statusMessageOverlay');
        const statusMessageText = document.getElementById('statusMessageText');
        const translationStatus = document.querySelector('.translation-status');
        
        if (endCounselBtn && statusMessageOverlay && statusMessageText) {
            endCounselBtn.addEventListener('click', () => {
                console.log('ìƒë‹´ ì¢…ë£Œ ë²„íŠ¼ í´ë¦­ë¨');
                
                // 1ë‹¨ê³„: ìƒë‹´ ì¢…ë£Œ ë©”ì‹œì§€
                statusMessageText.textContent = 'ìƒë‹´ì´ ì¢…ë£Œë©ë‹ˆë‹¤';
                statusMessageOverlay.style.display = 'flex';
                
                // ë²ˆì—­ ìƒíƒœ ìˆ¨ê¸°ê¸°
                if (translationStatus) {
                    translationStatus.style.opacity = '0.5';
                }
                
                // 2ì´ˆ í›„ ì €ì¥ ì¤‘ ë©”ì‹œì§€ë¡œ ë³€ê²½
                setTimeout(() => {
                    if (statusMessageText) {
                        statusMessageText.textContent = 'ìƒë‹´ ë‚´ìš©ì„ ì €ì¥ì¤‘ì…ë‹ˆë‹¤..';
                    }
                    
                    // 3ì´ˆ í›„ ì™„ë£Œ ë° í™”ë©´ ì •ë¦¬
                    setTimeout(() => {
                        if (statusMessageOverlay) {
                            statusMessageOverlay.style.display = 'none';
                        }
                        if (translationStatus) {
                            translationStatus.style.opacity = '1';
                        }
                        // ì—¬ê¸°ì— ì‹¤ì œ ì €ì¥ ë¡œì§ ì¶”ê°€ ê°€ëŠ¥
                    }, 3000);
                }, 2000);
            });
        } else {
            console.error('ìƒë‹´ ì¢…ë£Œ ë²„íŠ¼ ë˜ëŠ” ì˜¤ë²„ë ˆì´ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
        
        // ì´ˆê¸°í™” í•¨ìˆ˜
        function initializePage() {
            try {
                if (typeof renderCalendar === 'function') {
                    renderCalendar();
                }
                
                const topBtn = document.getElementById('topBtn');
                if (topBtn) {
                    topBtn.style.display = 'none';
                }
            } catch (error) {
                console.error('ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
            }
        }
        
        // DOMì´ ë¡œë“œë˜ë©´ ì‹¤í–‰
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePage);
        } else {
            // ì´ë¯¸ ë¡œë“œëœ ê²½ìš° ì¦‰ì‹œ ì‹¤í–‰
            initializePage();
        }
    </script>
</body>
</html>

